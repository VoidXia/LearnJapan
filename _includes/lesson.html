{% assign lesson = include.lesson %}
<div id="l{{include.num}}" class="lesson" markdown="1">
<div class="japan" markdown="1">
{% if lesson.title %}
{% assign title = lesson.title | prepend: "課　" | prepend: include.num | prepend: "第" %}
{% else %}
{% assign title = lesson.basic4 | newline_to_br | strip_newlines | split: '<br />' | first | remove: "。" | remove: "> * " | prepend: "課　" | prepend: include.num | prepend: "第" %}
{% endif %}
# {{title}}
## 基本課文
{{lesson.basic4}}

{{lesson.basicc}}

## {{lesson.contitle}}

{{lesson.context}}
 
</div>
## 基本课文译文
{{lesson.basic4t}}

{{lesson.basicct}}


## 应用课文译文 {{lesson.contitlet}}

{{lesson.contextt}}
 
## 语法点
{% assign findingNum = include.num | prepend: " " | append: " " %}
{% assign gs = site.data.grammar | where_exp: "item", "item.lesson contains findingNum" %}
| 句型、表达             | 解释                    |
| ----                   | ----                    | {% for grammar in gs %}
| {{grammar.expression}} | {{grammar.explanation}} | {% endfor %}

## 生词表

<audio id="wordplayer" controls style="margin-left: auto; margin-right: auto; display: block;">
  <source src="{{ site.baseurl }}/assets/audio/word/l{{include.num}}.mp3" type="audio/mpeg"/>
</audio>

{% assign ws = site.data.words | where_exp: "item", "item.lesson contains findingNum" %}
| 假名          | 单词          | 词性         | 解释          |
| ----          | ----          | ----         | ----          | {% for word in ws %}
| {{word.kana}} | {{word.word}} | {{word.pos}} | {{word.desc}} | {% endfor %}

<script>
$(document).ready(function() {
  lessonquizdata["l{{include.num}}"] = [
    {% for word in ws %}
      [ "{{word.kana | strip}}", "{{word.kanji | strip}}", "{{word.pos | strip}}", "{{word.desc | strip}}", "{{word.word | strip}}", "{{word.lesson | strip}}", "{{word.idx | strip}}"]{% unless forloop.last %},{% endunless %}{% endfor %}
    ]
    .map(function(p) {
      var rwords = JSON.parse(localStorage.getItem("rwords"));
      rwords = rwords || {};
      p[0]=japanruby(p[0]);
      p[4]=japanruby(p[4]);
      var desc = "<span class='japan'>" + (p[1] == "&nbsp;" ? p[0] : p[4] + "<br />" + p[0]) + "</span>";
      desc += "<span class='card-pos'>[" + p[2] + "]</span>";
      var rid = p[5]+'|'+p[6];
      return { tip: p[3], desc: desc, rem: rwords[rid], rid: rid }});
});
</script>

</div>
